@model IEnumerable<AssetManagement.Models.SecondOwnerPeripAlloc>

@{
    ViewData["Title"] = "Index";
    Layout = null;
}

<style>
    input {
        width: 400px!important;
    }
</style>


<h4>Second Owner Allocation</h4>

<table class="table table-striped table-datatable">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.LaptopPeripheral)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.LaptopPeripAlloc)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DatePurchased)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AgeYears)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Owner)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Status)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DateCreated)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DateUpdated)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CreatedBy)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.UpdatedBy)
            </th> 
            <th></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.LaptopPeripheral.PeripheralDescription)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.LaptopPeripAlloc.PeripheralAllocationId)
                </td>

                <td>
                    @Html.DisplayFor(modelItem => item.DatePurchased)
                </td>
                <td>

                    @{
                        if (item.DatePurchased != null)
                        {
                            var purchaseDate = item.DatePurchased.Value;
                            var now = DateTime.Now;

                            var totalDays = (now - purchaseDate).Days;

                            var years = now.Year - purchaseDate.Year;
                            var months = now.Month - purchaseDate.Month;
                            var days = now.Day - purchaseDate.Day;

                            if (days < 0)
                            {
                                months--;
                                days += DateTime.DaysInMonth(now.Year, now.AddMonths(-1).Month);
                            }

                            if (months < 0)
                            {
                                years--;
                                months += 12;
                            }

                            if (years > 0)
                            {
                                <span>@years year(s), @months month(s), @days day(s)</span>
                            }
                            else if (months > 0)
                            {
                                <span>@months month(s), @days day(s)</span>
                            }
                            else
                            {
                                <span>@days day(s)</span>
                            }
                        }
                        else
                        {
                            <span>N/A</span>
                        }
                    }
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Owner.OwnerFullName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Status.status_name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DateCreated)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DateUpdated)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CreatedBy.UserCode)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.UpdatedBy.UserCode)
                </td>
                <td>
                    <a class="btn btn-sm btn-outline-primary" asp-controller="SecondOwnerPeripAllocs" asp-action="Edit" asp-route-id="@item.SecAllocId">Edit</a>
                </td>
                <td>
                    <a class="btn btn-sm btn-outline-danger" asp-controller="SecondOwnerPeripAllocs" asp-action="DeleteAsEdit" asp-route-id="@item.SecAllocId">Delete</a>
                </td>
            </tr>
        }

    </tbody>
</table>

